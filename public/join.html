<!DOCTYPE html>
<html lang="el">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Join</title>

<style>
body{
  margin:0;
  background:#111;
  color:#fff;
  font-family:Arial;
  text-align:center;
}
#tokens{
  display:grid;
  grid-template-columns:repeat(4, 1fr);
  gap:25px;
  padding:30px;
  max-width:600px;
  margin:auto;
}
.token{
  font-size:50px;
  cursor:pointer;
}
#selected{ display:none; margin-top:80px; }
#myToken{ font-size:90px; margin-bottom:30px; }
button{
  font-size:24px;
  padding:15px 40px;
  border-radius:10px;
}
#dice{
  display:none;
  font-size:90px;
  margin-top:40px;
  cursor:pointer;
}
#msg{ margin-top:20px; font-size:22px; }
</style>
</head>
<body>

<h2>Î”Î¹Î¬Î»ÎµÎ¾Îµ Ï€Î¹ÏŒÎ½Î¹</h2>
<div id="tokens"></div>

<div id="selected">
  <div id="myToken"></div>
  <button id="readyBtn">Î•Î¯Î¼Î±Î¹ Î­Ï„Î¿Î¹Î¼Î¿Ï‚</button>
  <div id="dice">ğŸ²</div>
  <div id="msg">Î ÎµÏÎ¯Î¼ÎµÎ½Îµ Ï„Î· ÏƒÎµÎ¹ÏÎ¬ ÏƒÎ¿Ï…</div>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
const socket = io();
const mySocketId = socket.id;

const tokens=["ğŸ¶","ğŸ±","ğŸ­","ğŸ¹","ğŸ°","ğŸ¦Š","ğŸ»","ğŸ¼","ğŸ¸","ğŸµ"];
const container=document.getElementById("tokens");
const selected=document.getElementById("selected");
const myTokenDiv=document.getElementById("myToken");
const readyBtn=document.getElementById("readyBtn");
const dice=document.getElementById("dice");
const msg=document.getElementById("msg");

let myId=null;

socket.on("connect", ()=>{
  myId = socket.id;
});

tokens.forEach(t=>{
  const d=document.createElement("div");
  d.className="token";
  d.textContent=t;

  d.onclick=()=>{
    const name=prompt("ÎŒÎ½Î¿Î¼Î± Ï€Î±Î¯ÎºÏ„Î·:");
    if(!name) return;

    socket.emit("joinPlayer",{name,token:t});

    container.style.display="none";
    document.querySelector("h2").style.display="none";
    selected.style.display="block";
    myTokenDiv.textContent=t;
  };

  container.appendChild(d);
});

readyBtn.onclick=()=>{
  readyBtn.style.display="none";
};

socket.on("turnUpdate",(activeId)=>{
  if(activeId === myId){
    msg.textContent="Î— ÏƒÎµÎ¹ÏÎ¬ ÏƒÎ¿Ï…!";
    dice.style.display="block";
  }else{
    msg.textContent="Î ÎµÏÎ¯Î¼ÎµÎ½Îµ Ï„Î· ÏƒÎµÎ¹ÏÎ¬ ÏƒÎ¿Ï…";
    dice.style.display="none";
  }
});

dice.onclick=()=>{
  socket.emit("rollDice");
};

socket.on("diceResult",(data)=>{
  msg.textContent=`ÎŸ ${data.player} Î­Ï†ÎµÏÎµ ${data.roll}`;
});
</script>
</body>
</html>
