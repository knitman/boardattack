<!DOCTYPE html>
<html lang="el">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Join</title>

<style>
body{
  margin:0;
  background:#111;
  color:#fff;
  font-family:Arial, Helvetica, sans-serif;
  text-align:center;
}

/* GRID */
#tokens{
  display:grid;
  grid-template-columns:repeat(4, 1fr);
  gap:25px;
  padding:30px;
  max-width:600px;
  margin:auto;
}

.token{
  font-size:50px;
  cursor:pointer;
  transition:.2s;
}

.locked{
  opacity:0.2;
  pointer-events:none;
}

/* SELECTED SCREEN */
#selected{
  display:none;
  margin-top:80px;
}

#myToken{
  font-size:90px;
  margin-bottom:30px;
}

button{
  font-size:24px;
  padding:15px 40px;
  border:none;
  border-radius:10px;
  cursor:pointer;
}

#dice{
  display:none;
  font-size:80px;
  margin-top:40px;
}
</style>
</head>
<body>

<h2>Î”Î¹Î¬Î»ÎµÎ¾Îµ Ï€Î¹ÏŒÎ½Î¹</h2>
<div id="tokens"></div>

<div id="selected">
  <div id="myToken"></div>
  <button id="readyBtn">Î•Î¯Î¼Î±Î¹ Î­Ï„Î¿Î¹Î¼Î¿Ï‚</button>
  <div id="dice">ðŸŽ²</div>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
const socket = io();
const tokens=["ðŸ¶","ðŸ±","ðŸ­","ðŸ¹","ðŸ°","ðŸ¦Š","ðŸ»","ðŸ¼","ðŸ¸","ðŸµ"];
const container=document.getElementById("tokens");
const selected=document.getElementById("selected");
const myTokenDiv=document.getElementById("myToken");
const readyBtn=document.getElementById("readyBtn");
const dice=document.getElementById("dice");

let myToken=null;
let myName=null;

// Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Ï€Î¹Î¿Î½Î¹ÏŽÎ½
tokens.forEach(t=>{
  const d=document.createElement("div");
  d.className="token";
  d.textContent=t;

  d.onclick=()=>{
    myName=prompt("ÎŒÎ½Î¿Î¼Î± Ï€Î±Î¯ÎºÏ„Î·:");
    if(!myName) return;

    myToken=t;
    socket.emit("joinPlayer",{name:myName,token:myToken});

    // ÎšÏÏÏˆÎµ ÏŒÎ»Î±
    container.style.display="none";
    document.querySelector("h2").style.display="none";

    // Î”ÎµÎ¯Î¾Îµ Î¼ÏŒÎ½Î¿ Ï„Î¿ Î´Î¹ÎºÏŒ Ï„Î¿Ï…
    selected.style.display="block";
    myTokenDiv.textContent=myToken;
  };

  container.appendChild(d);
});

// ÎšÎ»ÎµÎ¯Î´Ï‰Î¼Î± Ï€Î¹Î¿Î½Î¹ÏŽÎ½
socket.on("updateTokens",(taken)=>{
  [...container.children].forEach(el=>{
    if(taken.includes(el.textContent)){
      el.classList.add("locked");
    }
  });
});

// ÎšÎ¿Ï…Î¼Ï€Î¯ Î­Ï„Î¿Î¹Î¼Î¿Ï‚
readyBtn.onclick=()=>{
  readyBtn.style.display="none";
  dice.style.display="block";
};
</script>
</body>
</html>
